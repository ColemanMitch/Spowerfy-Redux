(this["webpackJsonpspowerfy-redux"]=this["webpackJsonpspowerfy-redux"]||[]).push([[0],{24:function(e,t,i){},25:function(e,t,i){},43:function(e,t,i){"use strict";i.r(t);var s=i(0),a=i.n(s),n=i(7),c=i.n(n),r=(i(24),i(3)),l=i(4),o=i(2),h=i(6),u=i(5),d=(i(25),"https://api.spotify.com/v1"),y=function(){function e(){Object(r.a)(this,e),this._accessToken=null;var t=new URLSearchParams(window.location.search);this._accessToken=t.get("access_token"),this._accessToken||console.error("No access_token query param found")}return Object(l.a)(e,[{key:"getAccessToken",value:function(){return this._accessToken}},{key:"fetchMe",value:function(){return fetch("".concat(d,"/me"),{headers:{Authorization:"Bearer "+this._accessToken}})}},{key:"fetchDevices",value:function(){return fetch("".concat(d,"/me/player/devices"),{headers:{Authorization:"Bearer "+this._accessToken}})}},{key:"fetchPlaylists",value:function(){return fetch("".concat(d,"/me/playlists?limit=50"),{headers:{Authorization:"Bearer "+this._accessToken}})}},{key:"useDevice",value:function(e){return fetch("".concat(d,"/me/player"),{method:"PUT",headers:{Authorization:"Bearer "+this._accessToken},body:JSON.stringify({device_ids:[e],play:!0})})}},{key:"shuffle",value:function(){return fetch("".concat(d,"/me/player/shuffle?state=true"),{method:"PUT",headers:{Authorization:"Bearer "+this._accessToken}})}},{key:"skipSong",value:function(){return fetch("https://api.spotify.com/v1/me/player/next",{method:"POST",headers:{Authorization:"Bearer "+this._accessToken}})}},{key:"fetchCurrentlyPlaying",value:function(){return fetch("https://api.spotify.com/v1/me/player/currently-playing",{method:"GET",headers:{Authorization:"Bearer "+this._accessToken}})}},{key:"startPlaylist",value:function(e){return fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{Authorization:"Bearer "+this._accessToken},body:JSON.stringify({context_uri:e})})}}]),e}(),p=i(19),v=i(8),f=i.n(v),j=i(13),b=i(9),m=i(1),O=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e){var s;return Object(r.a)(this,i),(s=t.call(this,e)).initialTimer=Object(b.a)({},s.createTimeObj(10)),s.state={time:Object(b.a)({},s.initialTimer),songCount:1,ticking:!1},s.tick=Object(j.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(b.a)({},s.state.time),0!==s.state.time.seconds){e.next=8;break}if(0!==s.state.time.minutes){e.next=6;break}return s.props.skipToNextSong(),s.setState({time:s.createTimeObj(s.props.interval),songCount:s.state.songCount+1,ticking:!1}),e.abrupt("return");case 6:t.minutes-=1,t.seconds=60;case 8:t.seconds-=1,s.setState({time:t});case 10:case"end":return e.stop()}}),e)}))),s.startTimer=s.startTimer.bind(Object(o.a)(s)),s}return Object(l.a)(i,[{key:"componentDidMount",value:function(){this.setState({ticking:!0}),this.startTimer()}},{key:"componentDidUpdate",value:function(){this.state.ticking||(this.startTimer(),this.setState({ticking:!0}))}},{key:"startTimer",value:function(){var e=Object(j.a)(f.a.mark((function e(){var t,i,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(p.a)(Array(this.props.interval+1).keys()),e.prev=1,t.s();case 3:if((i=t.n()).done){e.next=9;break}return s=i.value,e.next=7,setTimeout(this.tick,1e3*(s+1));case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"createTimeObj",value:function(e){return{minutes:Math.floor(e/60),seconds:e%60}}},{key:"render",value:function(){return Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{className:"drink-counter",style:{float:"left"},children:[Object(m.jsx)("h4",{children:"Currently on"}),Object(m.jsxs)("h1",{children:["Drink #",this.state.songCount]})]}),Object(m.jsxs)("div",{className:"time-counter",style:{float:"right"},children:[Object(m.jsx)("h4",{children:"Time Remaining:"}),Object(m.jsxs)("h1",{children:[this.state.time.minutes,"m ",this.state.time.seconds,"s"]})]})]})}}]),i}(a.a.Component),k=function(){return Object(m.jsxs)("div",{className:"login-app-body",children:[Object(m.jsx)("header",{className:"nonfixed-header",children:Object(m.jsx)("h1",{className:"app-title-nonfixed",children:"Spowerfy \ud83c\udf7a"})}),Object(m.jsx)("button",{id:"sign-in-button",className:"center",onClick:function(){window.location.assign(window.location.href.includes("localhost")?"http://localhost:8888/login":"https://spowerfy-backend.herokuapp.com/login")},style:{fontSize:"20px"},children:"Sign in with Spotify"})]})},x=i(18),g=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e){var s;return Object(r.a)(this,i),(s=t.call(this,e)).setActivePlaylist=function(e){var t=e.target;s.props.setPlaylist(s.props.playlists.filter((function(e){return e.uri===t.value}))[0])},s.filterPlaylist=function(e){var t=e.target;s.setState({playlistFilter:t.value})},s.state={playlistFilter:""},s}return Object(l.a)(i,[{key:"checkIncludes",value:function(e,t){return e.toLowerCase().includes(t.toLowerCase())}},{key:"render",value:function(){var e=this;return Object(m.jsxs)("div",{children:[Object(m.jsx)("input",{id:"playlist-filter",placeholder:"Start typing to filter for your playlist",onChange:this.filterPlaylist,value:this.state.playlistFilter}),this.props.playlists.length>0?Object(m.jsx)("div",{children:Object(m.jsx)("div",{className:"playlist-container",children:Object(m.jsx)("ul",{children:Object(m.jsx)("form",{id:"playlist-select",children:this.props.playlists.filter((function(t){return e.checkIncludes(t.name.toLowerCase(),e.state.playlistFilter.toLowerCase())})).map((function(t){var i,s;return Object(m.jsxs)("div",{className:"playlist-div",children:[Object(m.jsx)("img",{className:"playlist-images",src:null===(i=t.images[0])||void 0===i?void 0:i.url,alt:"Playlist art"}),Object(m.jsxs)("li",{className:"playlist-item",children:[Object(m.jsx)("h3",{className:"playlist-name",children:t.name}),Object(m.jsx)("input",{type:"radio",checked:t.name===(null===(s=e.props.activePlaylist)||void 0===s?void 0:s.name),value:t.uri,name:"playlists",onChange:function(){return{}},onClick:e.setActivePlaylist,className:"playlist-radio"})]})]},t.uri)}))})})})}):Object(m.jsx)("p",{children:"Loading playlists..."})]})}}]),i}(s.Component),S=function(e){var t;return Object(m.jsxs)("div",{children:[Object(m.jsxs)("header",{className:"fixed-header",children:[Object(m.jsx)("h1",{className:"app-title",children:"Spowerfy \ud83c\udf7a"}),Object(m.jsx)("button",{className:"start-button",style:{float:"right"},onClick:e.startPlayback,children:"Click to start your power hour"})]}),Object(m.jsxs)("div",{className:"app-body",children:[Object(m.jsxs)("h2",{children:["Hello ",null===(t=e.user)||void 0===t?void 0:t.name,","]}),Object(m.jsx)("br",{}),e.devices?Object(m.jsxs)("ul",{id:"device-dropdown",children:[Object(m.jsx)("h3",{children:"Select your playback device"}),Object(m.jsx)(x.a,{className:"playback-device-select",options:e.devices.map((function(e){return{label:e.name,value:e.id}})),onChange:e.handleDevice})]}):Object(m.jsx)("p",{children:"Loading devices..."}),Object(m.jsx)(g,{playlists:e.playlists,activePlaylist:e.activePlaylist,setPlaylist:e.setPlaylist})]})]})},P=i(16),T=i(17),C=i.n(T),w=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e){var s;return Object(r.a)(this,i),(s=t.call(this,e)).spotifyService=void 0,s.state=void 0,s.handleDevice=function(e){s.setState({playbackDeviceId:e.value})},s.setPlaylist=function(e){s.setState({activePlaylist:e})},s.state={authenticated:!1,filterString:"",playbackDeviceId:"",playlists:[],filteredPlaylists:[],partyStarted:!1,devices:[],songLoaded:!1,interval:10},s.spotifyService=new y,s.startPlayback=s.startPlayback.bind(Object(o.a)(s)),s.fetchCurrentlyPlaying=s.fetchCurrentlyPlaying.bind(Object(o.a)(s)),s.skipToNextSong=s.skipToNextSong.bind(Object(o.a)(s)),s.changeInterval=s.changeInterval.bind(Object(o.a)(s)),s}return Object(l.a)(i,[{key:"componentDidMount",value:function(){var e=this;this.spotifyService.fetchMe().then((function(t){t.json().then((function(t){t.display_name&&e.setState({user:{name:t.display_name}})}))})),this.spotifyService.fetchDevices().then((function(t){t.json().then((function(t){t.devices&&e.setState({devices:t.devices})}))})),this.spotifyService.fetchPlaylists().then((function(t){t.json().then((function(t){t.items&&e.setState({playlists:t.items,filteredPlaylists:t.items})}))}))}},{key:"startPlayback",value:function(){var e=this;this.state.playbackDeviceId&&this.state.activePlaylist?this.spotifyService.useDevice(this.state.playbackDeviceId).then((function(t){204===t.status&&setTimeout((function(){var t,i;return e.spotifyService.startPlaylist(null!==(t=null===(i=e.state.activePlaylist)||void 0===i?void 0:i.uri)&&void 0!==t?t:"").then((function(){e.spotifyService.shuffle().then((function(){e.setState({partyStarted:!0}),setTimeout((function(){return e.fetchCurrentlyPlaying()}),1e3),setTimeout((function(){return e.fetchCurrentlyPlaying()}),2500)}))}))}),1e3)})):alert("Select both a device and a playlist to get this party started!")}},{key:"fetchCurrentlyPlaying",value:function(){var e=this;this.spotifyService.fetchCurrentlyPlaying().then((function(t){t.json().then((function(t){t.item&&e.setState({activeSong:t.item})}))}))}},{key:"skipToNextSong",value:function(){var e=this;this.spotifyService.skipSong().then((function(t){var i;null===(i=t.body)||void 0===i||i.getReader().read().then((function(t){(null===t||void 0===t?void 0:t.done)&&setTimeout((function(){return e.fetchCurrentlyPlaying()}),1e3)}))}))}},{key:"changeInterval",value:function(e){var t=C()(e.target.value);this.setState({interval:t})}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"App",children:[this.state.partyStarted?Object(m.jsxs)("div",{className:"party-time app-body",children:[Object(m.jsx)("header",{className:"nonfixed-header",children:Object(m.jsx)("h1",{className:"app-title-nonfixed",children:"Spowerfy \ud83c\udf7a"})}),Object(m.jsx)("h2",{children:"Currently Playing: "}),Object(m.jsx)(O,{skipToNextSong:this.skipToNextSong,interval:this.state.interval}),this.state.activeSong?Object(m.jsxs)("div",{children:[Object(m.jsx)("img",{src:this.state.activeSong.album.images[0].url,alt:"album art of the current track"}),Object(m.jsx)("h3",{style:{fontWeight:"bold"},children:this.state.activeSong.name}),Object(m.jsx)("h4",{className:"artist-name",children:this.state.activeSong.album.artists[0].name}),Object(m.jsxs)("div",{children:[Object(m.jsx)("p",{children:"Change the interval between songs?"}),Object(m.jsx)(P.RangeStepInput,{min:5,max:120,onChange:this.changeInterval,value:this.state.interval,step:5}),this.state.interval," seconds"]})]}):Object(m.jsx)("p",{children:"Loading playback.."})]}):Object(m.jsx)("div",{children:this.state.user?Object(m.jsx)(S,{devices:this.state.devices,playlists:this.state.playlists,user:this.state.user,activePlaylist:this.state.activePlaylist,setPlaylist:this.setPlaylist,handleDevice:this.handleDevice,startPlayback:this.startPlayback}):Object(m.jsx)(k,{})}),Object(m.jsx)("footer",{children:Object(m.jsxs)("p",{children:["Made by ",Object(m.jsx)("a",{href:"https://www.github.com/ColemanMitch",children:"Cole Mitchell"})," & ",Object(m.jsx)("a",{href:"https://github.com/dwilliams27",children:"David Williams"})]})})]})}}]),i}(s.Component),N=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,44)).then((function(t){var i=t.getCLS,s=t.getFID,a=t.getFCP,n=t.getLCP,c=t.getTTFB;i(e),s(e),a(e),n(e),c(e)}))};c.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(w,{})}),document.getElementById("root")),N()}},[[43,1,2]]]);
//# sourceMappingURL=main.624471a3.chunk.js.map